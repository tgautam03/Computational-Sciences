<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Differential and Difference Equations</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Everything High Performance">
    <link rel="canonical" href="http://localhost:4000/Computational-Sciences/2023/09/20/Differential-Difference-Equations/">
    <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Computational Science and Engineering posts" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/Computational-Sciences/css/main.css">

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-3698471-23', 'auto');
      ga('send', 'pageview');
    </script>

</head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <div style="float:left; margin-top:10px; margin-right:10px;">
    <a href="/Computational-Sciences/feed.xml">
      <img src="/assets/rssicon.svg" width="40">
    </a>
    </div>

    <a class="site-title" href="/Computational-Sciences/">Computational Science and Engineering</a>
    
    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        
          
        
          
        
      </div>
    </nav>
  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>Differential and Difference Equations</h1>
    <p class="meta">Sep 20, 2023</p>
  </header>

  <article class="post-content">
  <h2 id="introduction">Introduction</h2>
<p>Consider a scenario where a <em>thin, insulated</em> metal rod is put on an <em>infinite block of ice at both ends</em> and a <em>blowtorch</em> is heating it along it’s length (see Figure 1). The task is to find the temperature at several locations along the bar when it reaches steady state (i.e. when there’s no change in temperature of the rod with time).</p>

<div class="imgcap">
  <img src="https://raw.githubusercontent.com/tgautam03/Computational-Sciences/gh-pages/assets/2023-09-20-Differential-Difference-Equations/Figure1.png" alt="this slowpoke moves" width="800" />
  <div class="thecap">Figure 1: A thin metal rod with both ends attached to ice blocks and blowtorch heating it. </div>
</div>

<blockquote>
  <p>In the above description, we actually received almost all the assumptions for the problem:</p>
  <ul>
    <li><em>Thin</em>: It’s just a 1D problem with probably \(x\) used to denote the location along the length of the rod.</li>
    <li><em>Insulated</em>: No energy loss due to radiation from the surface of the rod to the surroundings.</li>
  </ul>
</blockquote>

<p>The <em>Partial Differential Equation</em> (PDE) with boundary conditions explaining this scenario is known as the <strong>Heat Equation</strong> (Steady-State in this case).</p>

\[-\frac{d^2u}{dx^2}=f(x) \ \ \forall \ 0 \le x \le 1; \ \ \ \ \ \ \ \ \ \ u(0)=u(1)=0 \tag{1}\]

<blockquote>
  <p>Note that</p>
  <ul>
    <li>The temperature distribution along the length of the rod which ranges between 0 and 1 is given as \(u(x)\),</li>
    <li>The source term (<em>blowtorch</em>) is defined as \(f(x)\) and,</li>
    <li>The boundary conditions \(u(x)=u(1)=0\) represent the <em>ice block</em> at the ends.</li>
  </ul>
</blockquote>

<blockquote>
  <p>The complete Heat Equation is derived using conservation of heat energy and Fourier’s Law of Heat Conduction, details to which can be found in my <a href="">YouTube Video</a> or the <a href="">Blog Post</a> on this topic.</p>
</blockquote>

<h3 id="why-are-boundary-conditions-so-important">Why are <em>Boundary Conditions</em> so important?</h3>
<p>For the time being, set \(f(x)=1\). Now looking at the differential equation, what we need is some function \(u(x)\) that satisfies \(-\frac{d^2u}{dx^2}=1\). For this simple problem, we can integrate both sides twice and get a solution \(u(x)=-\frac{1}{2}x^2 + Cx + D\) where \(C\) and \(D\) can be any constants! This is where boundary conditions \(u(0)=u(1)=0\) fix the values of \(C\), \(D\) and gives us a unique solution \(u(x)=-\frac{1}{2}x^2 + \frac{1}{2}x\).</p>

<h3 id="finite-differences">Finite Differences</h3>
<p>In order to solve the PDE on a computer, we need to find a way to represent or approximate the derivatives numerically, which is done using Finite Differences. From <em>Taylor Series</em>, we know that</p>

\[u(x+h) = u(x) + h u'(x) + \frac{h^2}{2!}u''(x) + \frac{h^3}{3!}u'''(x) + \cdots \tag{2}\]

<p>and</p>

\[u(x-h) = u(x) - h u'(x) + \frac{h^2}{2!}u''(x) - \frac{h^3}{3!}u'''(x) + \cdots \tag{3}\]

<p>Rearranging Equation \((2)\), we can get the <em>Forward Difference Approximation</em> to the 1st order derivative</p>

\[\begin{aligned}
\frac{u(x+h) -  u(x)}{h} &amp; = u'(x) + \frac{h}{2!}u''(x) + \frac{h^2}{3!}u'''(x) + \cdots \\
                        &amp; = u'(x) + \mathcal{O}(h) 
\end{aligned} \tag{4}\]

<p>Similarly from Equation \((3)\), we can get the <em>Backward Difference Approximation</em> to the 1st order derivative</p>

\[\begin{aligned}
\frac{u(x) -  u(x-h)}{h} &amp; = u'(x) - \frac{h}{2!}u''(x) + \frac{h^2}{3!}u'''(x) + \cdots \\
                        &amp; = u'(x) + \mathcal{O}(h) 
\end{aligned} \tag{5}\]

<p>Finally, subtracting Equation \((3)\) from Equation \((2)\), we can get the <em>Centered Difference Approximation</em> to the 1st order derivative</p>

\[\begin{aligned}
\frac{u(x+h) -  u(x-h)}{2h} &amp; = u'(x) + \frac{2h^2}{3!}u'''(x) + \cdots \\
                        &amp; = u'(x) + \mathcal{O}(h^2) 
\end{aligned} \tag{6}\]

<blockquote>
  <p><em>Centered Difference</em> is 2nd order Accurate in \(h\) while others are 1st order Accurate in \(h\)!</p>
</blockquote>

<p>We can also add Equations \((2)\) and \((3)\), to get an approximation to 2nd order derivative</p>

\[\begin{aligned}
\frac{u(x+h) - 2u(x) +  u(x-h)}{h^2} &amp; = u''(x) + \frac{2h^2}{4!}u''''(x) + \cdots \\
                        &amp; = u''(x) + \mathcal{O}(h^2) 
\end{aligned} \tag{7}\]

<blockquote>
  <p>2nd order derivative is by default 2nd order accurate in \(h\)!</p>
</blockquote>

<h2 id="difference-equation">Difference Equation</h2>
<p>The next step is to use the above defined equations \((2)\) through \((7)\) and convert the <em>Differential Equation</em> to a <em>Difference Equation</em>. For this, we need <strong>numerical descretisation</strong>.</p>

<h3 id="numerical-discretisation">Numerical Discretisation</h3>
<p>Considering the PDE in Equation \((1)\), where the domain lies between 0 and 1. What discretisation does is represent this continuous domain using a finite set of points. As shown in Figure 2, I’m discretising the domain into 5 equispaced points with distance \(h\) between the two adjacent points.</p>

<h3 id="solution">Solution</h3>

  </article>

  <!-- mathjax -->
  
  
  <!-- disqus comments -->
 
  
</div>
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <!-- <h2 class="footer-heading">Computational Science and Engineering</h2> -->

    <div class="footer-col-1 column">
      <ul>
        <li>Computational Science and Engineering</li>
        <!-- <li><a href="mailto:[first_name(without caps)].[last_name(without caps)][at]utah.edu">[first_name(without caps)].[last_name(without caps)][at]utah.edu</a></li> -->
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/tgautam03">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">tgautam03</span>
          </a>
        </li>
        
      </ul>
    </div>

    <div class="footer-col-3 column">
      <p class="text">Everything High Performance</p>
    </div>

  </div>

</footer>


    </body>
</html>

<script type="text/javascript">
window.MathJax = {
  tex: {
    packages: ['base', 'ams']
  },
  loader: {
    load: ['ui/menu', '[tex]/ams']
  }
};
</script>

<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>
